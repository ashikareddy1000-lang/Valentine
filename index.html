<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Will You Be My Boobie Piccolo Forever? ğŸ’–</title>
  <style>
    :root{
      --bg1:#ffe7ef; --bg2:#ffd1e0; --primary:#ff4d79; --primary-dark:#e23f6a;
      --text:#5a2a3b; --white:#fff; --ok:#14b8a6;
    }

    html,body{
      height:100%; margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      color:var(--text); overflow-x:hidden;
      background:
        radial-gradient(1200px 1200px at 20% 10%, var(--bg1), transparent),
        radial-gradient(1200px 1200px at 80% 0%, var(--bg2), transparent),
        linear-gradient(160deg, #fff, #ffeef4 60%, #ffe3ed);
    }

    .wrap{
      min-height:100dvh; display:flex; align-items:center; justify-content:center;
      padding:24px; width:min(720px, 92vw); margin-inline:auto;
    }

    .card{
      width:100%; background:var(--white); border-radius:24px;
      box-shadow:0 15px 40px rgba(255, 77, 121, 0.20), 0 6px 18px rgba(0,0,0,0.08);
      padding: clamp(22px, 4vw, 44px); text-align:center;
    }

    .title{ font-size: clamp(28px, 4.6vw, 44px); margin-bottom: 10px; color:var(--primary-dark); }
    .subtitle{ font-size: clamp(14px, 2.8vw, 18px); opacity:0.9; margin-bottom: 22px; }
    .buttons{ display:flex; justify-content:center; gap:16px; flex-wrap:wrap; }

    .btn{
      padding:14px 22px; font-size: clamp(15px, 2.8vw, 18px); border:none; border-radius:12px;
      cursor:pointer; transition: transform .05s ease, box-shadow .2s ease, background .2s ease;
    }
    .btn:active { transform: translateY(1px); }
    #yes{ background:var(--primary); color:#fff; box-shadow:0 6px 14px rgba(226,63,106,.28); }
    #no{ background:#ffe1ea; color:#b02a4a; }

    /* Floating hearts (ambient) */
    .heart{
      position:fixed; bottom:-30px; font-size: 18px; opacity:0;
      animation: floatUp 6.5s linear forwards; pointer-events:none; will-change: transform, opacity;
    }
    @keyframes floatUp{
      0%{opacity:0; transform:translateY(0);}
      10%{opacity:1;}
      100%{opacity:0; transform:translateY(-120vh);}
    }

    /* Overlay & modal */
    .overlay{
      position:fixed; inset:0; background:rgba(255, 224, 234, 0.85);
      display:flex; align-items:center; justify-content:center;
      visibility:hidden; opacity:0; transition:0.3s; padding:20px;
    }
    .overlay.show{ visibility:visible; opacity:1; }

    .modal{
      background:#fff; width:min(720px, 94vw); padding:24px;
      border-radius:20px; box-shadow:0 10px 28px rgba(0,0,0,.08);
    }

    .modal h2{ margin: 0 0 6px 0; }
    .lead{ margin:0 0 14px 0; opacity:.85; }

    .progress-wrap{ background:#ffeaf1; border-radius:12px; height:10px; overflow:hidden; margin:14px 0 20px 0; }
    .progress-bar{ height:100%; background:linear-gradient(90deg, var(--primary), #ff7aa1); width:0%; transition:width .25s ease; }

    .q{ padding:14px 0 8px 0; font-weight:600; color:#9a3553; }

    .options{ display:grid; grid-template-columns: 1fr; gap:10px; margin: 4px 0 8px 0; }
    .opt{
      display:flex; align-items:flex-start; gap:10px; padding:12px; border-radius:12px;
      background:#fff7fa; border:1px solid #ffd3e0; cursor:pointer;
    }
    .opt input{ margin-top:3px; }

    .nav{ display:flex; justify-content:space-between; gap:12px; margin-top:18px; flex-wrap:wrap; }
    .link-quiet{ background:transparent; border:none; color:#b02a4a; cursor:pointer; padding:10px 12px; }
    .btn-next{ background:var(--primary); color:#fff; }
    .btn-back{ background:#ffe1ea; color:#b02a4a; }
    .btn-finish{ background:var(--ok); color:#fff; }

    .note{ font-size:14px; color:#b02a4a; margin-top:10px; display:none; }
    .summary{
      background:#fff7fa; border:1px solid #ffd3e0; border-radius:12px; padding:12px; margin:12px 0 0;
      font-size:15px;
    }

    /* Tiny confetti hearts burst (existing) */
    .burst{ position:fixed; inset:0; pointer-events:none; }
    .burst .p{ position:absolute; font-size:20px; opacity:0; animation:pop 1000ms ease forwards; }
    @keyframes pop{
      0% { transform: translate(0,0) scale(.6); opacity:0; }
      20% { opacity:1; }
      100% { transform: translate(var(--dx), var(--dy)) scale(1.4); opacity:0; }
    }

    @media (min-width: 560px){ .options{ grid-template-columns: 1fr 1fr; } }

    /* === FESTIVAL FINALE STYLES === */
    .finale-layer{ position:fixed; inset:0; pointer-events:none; z-index:9999; }

    /* LOVE YOU overlay */
    .love-overlay{ position:absolute; inset:0; overflow:hidden; display:grid; place-items:center; background:transparent; opacity:0; animation: loveFade 400ms ease forwards 200ms; }
    @keyframes loveFade{ to{ opacity:0.25; } }
    .love-col{
      position:absolute; top:-150%; bottom:-150%; width:max(18vw, 220px);
      color:#ff4d79; opacity:.18; font-weight:700; line-height:1.6; text-align:center;
      text-shadow: 0 1px 0 rgba(255,255,255,.7); transform:rotate(-12deg);
      filter: drop-shadow(0 2px 2px rgba(0,0,0,.05)); animation: loveDrift 10s linear infinite;
      will-change: transform;
    }
    @keyframes loveDrift{ 0%{ transform: translateY(0) rotate(-12deg); } 100%{ transform: translateY(40%) rotate(-12deg); } }

    /* Emoji Rain */
    .love-rain{ position:absolute; inset:0; overflow:hidden; }
    .drop{
      position:absolute; top:-60px; font-size: clamp(20px, 3.5vw, 34px);
      animation: fall var(--dur, 6s) linear forwards; will-change: transform, opacity; opacity:.95;
    }
    @keyframes fall{
      0%{ transform: translateY(-80px) translateX(0) rotate(0deg); opacity:0; }
      8%{ opacity:1; }
      100%{ transform: translateY(110vh) translateX(var(--sx, 0px)) rotate(var(--rot, 0deg)); opacity:0.85; }
    }

    /* Big center blast pieces */
    .blast{ position:absolute; left:50%; top:50%; transform: translate(-50%, -50%); }
    .piece{
      position:absolute; font-size: clamp(24px, 4.8vw, 42px);
      animation: explode 1100ms ease-out forwards, spin 1100ms linear forwards; will-change: transform, opacity;
    }
    @keyframes explode{ 0%{ transform: translate(0,0) scale(.4); opacity:0; } 18%{ opacity:1; } 100%{ transform: translate(var(--dx), var(--dy)) scale(1.2); opacity:0; } }
    @keyframes spin{ to{ transform: rotate(1turn); } }

    /* Summary glow on finale */
    .summary.glow{ box-shadow: 0 0 0 0 rgba(255,77,121,.55); animation: pulse 1200ms ease-out 2; }
    @keyframes pulse{
      0%{ box-shadow:0 0 0 0 rgba(255,77,121,.55); }
      70%{ box-shadow:0 0 24px 10px rgba(255,77,121,.28); }
      100%{ box-shadow:0 0 0 0 rgba(255,77,121,0); }
    }

    /* Balloons with labels */
    .balloons{ position:absolute; inset:0; overflow:hidden; }
    .balloon{
      position:absolute; bottom:-10vh; font-size: clamp(26px, 5vw, 44px);
      animation: rise var(--dur, 8s) ease-in forwards; filter: drop-shadow(0 6px 10px rgba(0,0,0,.08));
      display:flex; flex-direction:column; align-items:center; gap:2px;
    }
    .balloon .label{
      font-size: clamp(10px, 2.6vw, 14px);
      background: rgba(255,255,255,.75); color:#b02a4a;
      border:1px solid #ffd3e0; border-radius:999px; padding:2px 8px;
      transform: translateY(-6px); backdrop-filter: blur(2px);
      box-shadow: 0 2px 6px rgba(226,63,106,.15);
    }
    @keyframes rise{
      0%{ transform: translate(calc(var(--x,0px)), 10vh) rotate(0deg); opacity:.95; }
      45%{ transform: translate(calc(var(--x,0px) + var(--sway, 0px)), -10vh) rotate(2deg); }
      100%{ transform: translate(calc(var(--x,0px) + var(--sway, 0px)), -120vh) rotate(-2deg); opacity:0; }
    }

    /* Rose garden */
    .garden{ position:absolute; left:0; right:0; bottom:0; height:35vh; pointer-events:none; display:flex; align-items:flex-end; justify-content:center; gap:10px; }
    .rose{
      font-size: clamp(18px, 3.6vw, 30px); transform-origin: bottom center; transform: scaleY(0) translateY(20px);
      animation: growUp var(--gdur, 2.4s) ease-out forwards; filter: drop-shadow(0 2px 1px rgba(0,0,0,.06));
    }
    @keyframes growUp{ 0%{ transform: scaleY(0) translateY(20px); opacity:.6; } 80%{ transform: scaleY(1.05) translateY(0); opacity:1; } 100%{ transform: scaleY(1) translateY(0); } }

    /* Typewriter banner */
    .typewriter{
      position:absolute; top:6%; left:50%; transform:translateX(-50%);
      background: rgba(255,255,255,.65);
      border:1px solid #ffd3e0; padding:10px 14px; border-radius:14px;
      font-weight:700; color:#b02a4a; text-align:center;
      backdrop-filter: blur(4px);
      box-shadow: 0 6px 20px rgba(226,63,106,.15);
      opacity:0; animation: twIn .4s ease forwards;
      max-width:min(94vw, 720px);
    }
    @keyframes twIn{ to{ opacity:1; } }
    .caret{ display:inline-block; width:10px; margin-left:4px; border-right:2px solid #b02a4a; animation: blink 900ms step-end infinite; }
    @keyframes blink{ 50%{ border-color: transparent; } }

    /* Cursor trail */
    .trail{
      position:fixed; font-size:18px; pointer-events:none; opacity:0;
      transform: translate(-50%, -50%) scale(.6);
      animation: trailFade .9s ease-out forwards; will-change: transform, opacity;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,.12));
      z-index: 10000;
    }
    @keyframes trailFade{ 0%{ opacity:.95; transform: translate(-50%, -50%) scale(.6); } 100%{ opacity:0; transform: translate(-50%, -80%) scale(1.2); } }

    /* Photo frame reveal */
    .photo-wrap{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%) scale(.6) rotate(-2deg);
      background:#fff; border:6px solid #fff; border-radius:18px; overflow:hidden;
      box-shadow: 0 18px 60px rgba(226,63,106,.25), 0 10px 24px rgba(0,0,0,.08);
      opacity:0; animation: photoIn .8s cubic-bezier(.18,.89,.32,1.28) forwards;
      display:flex; flex-direction:column; align-items:center; gap:8px;
      pointer-events:none; max-width:min(84vw, 420px);
    }
    .photo{ width:100%; aspect-ratio: 4/5; object-fit: cover; background:#ffe6ef; }
    .caption{
      width:100%; text-align:center; padding:8px 10px; font-weight:700; color:#b02a4a;
      background:linear-gradient(180deg, #fff, #fff6f9);
      border-top:1px solid #ffe3ed;
    }
    @keyframes photoIn{ to{ opacity:1; transform:translate(-50%,-50%) scale(1) rotate(0deg); } }

    /* Frame sparkles */
    .sparkle{ position:absolute; font-size:18px; opacity:0; animation: sparklePop 1200ms ease-out forwards; }
    @keyframes sparklePop{
      0%{ transform: scale(.2) translateY(0); opacity:0; }
      30%{ opacity:1; }
      100%{ transform: scale(1.2) translateY(-14px); opacity:0; }
    }
  </style>
</head>

<body>

  <div class="wrap">
    <div class="card">
      <div style="font-size:38px">ğŸ’˜</div>
      <h1 class="title">Will you be my Boobie Piccolo forever?</h1>
      <p class="subtitle">Choose wiselyâ€¦ destiny (and cuddles) await ğŸ˜Œ</p>

      <div class="buttons">
        <button id="yes" class="btn">Yes ğŸ’–</button>
        <button id="no" class="btn">No ğŸ˜…</button>
      </div>
    </div>
  </div>

  <!-- Modal / Quiz -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="quizTitle">
      <h2 id="quizTitle">Yay! Quick fun questions ğŸ˜„</h2>
      <p class="lead">Pick what speaks to your heart:</p>

      <div class="progress-wrap" aria-hidden="true">
        <div class="progress-bar" id="progress"></div>
      </div>

      <!-- Step 1 -->
      <section class="step" data-step="1">
        <div class="q">1) Select your future role ğŸ˜Œ</div>
        <div class="options">
          <label class="opt"><input type="radio" name="role" value="CEO of My Heart â¤ï¸" /> Having Kids before marriage â¤ï¸</label>
          <label class="opt"><input type="radio" name="role" value="Chief Cuddle Officer ğŸ§¸" /> Having Kids after marriage ğŸ§¸</label>
          <label class="opt"><input type="radio" name="role" value="Permanent Valentine ğŸ’˜" /> Well Romantic Husband ğŸ’˜</label>
          <label class="opt"><input type="radio" name="role" value="Piccoloâ€™s Favorite Human ğŸŒ±ğŸ’š" /> All of the above ğŸŒ±ğŸ’š</label>
        </div>
        <div class="note" id="note-1">Please select one option to continue.</div>
        <div class="nav">
          <button class="btn btn-back" data-prev disabled>Back</button>
          <button class="btn btn-next" data-next>Next â†’</button>
        </div>
      </section>

      <!-- Step 2 -->
      <section class="step" data-step="2" hidden>
        <div class="q">2) Our perfect date night isâ€¦ âœ¨</div>
        <div class="options">
          <label class="opt"><input type="radio" name="date" value="Stargazing + Hot Chocolate ğŸŒŒâ˜•" /> Stargazing + Hot Chocolate ğŸŒŒâ˜•</label>
          <label class="opt"><input type="radio" name="date" value="Cozy movie & blanket fort ğŸ¬ğŸ›‹ï¸" /> Cozy movie & blanket fort ğŸ¬ğŸ›‹ï¸</label>
          <label class="opt"><input type="radio" name="date" value="Long drive + late-night talks ğŸš—ğŸ’¬" /> Long drive + late-night talks ğŸš—ğŸ’¬</label>
          <label class="opt"><input type="radio" name="date" value="Training with Piccolo, then ramen ğŸ¥‹ğŸœ" /> Training with Piccolo, then ramen ğŸ¥‹ğŸœ</label>
        </div>
        <div class="note" id="note-2">Please select one option to continue.</div>
        <div class="nav">
          <button class="btn btn-back" data-prev>â† Back</button>
          <button class="btn btn-next" data-next>Next â†’</button>
        </div>
      </section>

      <!-- Step 3 -->
      <section class="step" data-step="3" hidden>
        <div class="q">3) Pinky promise: What do you want forever? ğŸ¥¹</div>
        <div class="options">
          <label class="opt"><input type="radio" name="promise" value="Morning texts & warm hugs ğŸŒğŸ¤—" /> Morning texts & warm hugs ğŸŒğŸ¤—</label>
          <label class="opt"><input type="radio" name="promise" value="Adventures & inside jokes âœˆï¸ğŸ˜‚" /> Adventures & inside jokes & Romance âœˆï¸ğŸ˜‚</label>
          <label class="opt"><input type="radio" name="promise" value="Unwavering support & patience ğŸ’ªğŸ’" /> Unwavering support & patience ğŸ’ªğŸ’</label>
          <label class="opt"><input type="radio" name="promise" value="Training arcs together like Piccolo & Gohan ğŸ’š" /> Training arcs together & Travelling together ğŸ’š</label>
        </div>
        <div class="note" id="note-3">Please select one option to finish.</div>
        <div class="nav">
          <button class="btn btn-back" data-prev>â† Back</button>
          <button class="btn btn-finish" id="finish">Finish ğŸ‰</button>
        </div>

        <!-- Summary appears only after finish -->
        <div id="summary" class="summary" hidden></div>
        <div class="buttons" style="margin-top:12px;">
          <button id="close" class="btn link-quiet" hidden>Close</button>
        </div>
      </section>
    </div>
  </div>

  <!-- Hearts Burst Container -->
  <div class="burst" id="burst" aria-hidden="true"></div>

  <script>
    /* =========================================================
       âœ¨ CONFIG: Edit these to personalize!
       ========================================================= */
    const CONFIG = {
      names: { left: "Ashika", right: "Tharkesh", initials: "A â™¥ T" },
      photoUrl: "", // e.g., "images/us.jpg" â€” leave empty to show a cute placeholder
      quotes: [
        "You + Me = Home ğŸ¡â¤ï¸",
        "Every day with you is my favorite day âœ¨",
        "Forever is better with you ğŸ’˜",
        "My heart chooses you, always ğŸ’",
        "From this moment, always us ğŸ’"
      ],
      finaleMs: 12000,          // total time the big finale layer stays
      rainDurationMs: 9500,     // emoji rain duration
      cursorTrailMs: 6000,      // how long the cursor trail is active
      balloonCount: 14,
      roseCount: 28
    };

    /* =========================================================
       Floating Hearts (ambient)
       ========================================================= */
    const HEARTS = ['ğŸ’–','ğŸ’—','ğŸ’','ğŸ’•','â¤ï¸','ğŸ’“','ğŸ’œ','ğŸ’š'];
    setInterval(() => {
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = HEARTS[Math.floor(Math.random()*HEARTS.length)];
      h.style.left = Math.random() * 100 + "vw";
      h.style.fontSize = (18 + Math.random()*20) + "px";
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 6500);
    }, 700);

    /* =========================================================
       Basic UI wiring
       ========================================================= */
    const btnNo = document.getElementById("no");
    const btnYes = document.getElementById("yes");
    const overlay = document.getElementById("overlay");
    const progress = document.getElementById("progress");
    const steps = Array.from(document.querySelectorAll(".step"));
    const finishBtn = document.getElementById("finish");
    const summaryBox = document.getElementById("summary");
    const closeBtn = document.getElementById("close");
    const burst = document.getElementById("burst");

    let current = 1;
    const last = steps.length;
    const answers = { role:null, date:null, promise:null };

    btnNo.onclick = () => alert("No is not allowed ğŸ˜Œ Try again!");
    btnYes.onclick = () => { overlay.classList.add("show"); overlay.setAttribute('aria-hidden', 'false'); goTo(1); };

    function goTo(step){
      current = step;
      steps.forEach(s => s.hidden = Number(s.dataset.step) !== step);
      const pct = Math.round((step-1)/(last-1) * 100);
      progress.style.width = pct + "%";
      const backBtn = steps[step-1].querySelector("[data-prev]");
      if(backBtn) backBtn.disabled = (step === 1);
    }

    function getSelected(name){ const el = document.querySelector(`input[name="${name}"]:checked`); return el ? el.value : null; }

    function validate(step){
      const map = {1:'role', 2:'date', 3:'promise'};
      const name = map[step];
      const val = getSelected(name);
      const note = document.getElementById(`note-${step}`);
      if(!val){ if(note) note.style.display = 'block'; return false; }
      if(note) note.style.display = 'none';
      answers[name] = val;
      return true;
    }

    document.querySelectorAll("[data-next]").forEach(btn=>{
      btn.addEventListener('click', ()=>{ if(!validate(current)) return; if(current < last) goTo(current+1); });
    });
    document.querySelectorAll("[data-prev]").forEach(btn=>{
      btn.addEventListener('click', ()=>{ if(current > 1) goTo(current-1); });
    });

    finishBtn.onclick = () => {
      if(!validate(3)) return;
      const lines = [
        `Role chosen: <b>${answers.role}</b>`,
        `Perfect date: <b>${answers.date}</b>`,
        `Forever promise: <b>${answers.promise}</b>`
      ];
      summaryBox.innerHTML = `
        <h3 style="margin:4px 0 6px 0;">Itâ€™s official â¤ï¸</h3>
        <p style="margin:0 0 8px 0;">You said <b>Yes</b>â€”and Iâ€™m keeping this forever! ğŸ¥°</p>
        <div>${lines.map(l=>`<div>â€¢ ${l}</div>`).join('')}</div>
      `;
      summaryBox.hidden = false;
      summaryBox.classList.add('glow');
      setTimeout(()=>summaryBox.classList.remove('glow'), 2400);

      closeBtn.hidden = false;

      miniBurst();            // keep the tiny pop
      grandFinaleFestival();  // new festival mode
      playChime();            // gentle audio cue

      finishBtn.disabled = true;
    };

    closeBtn.onclick = () => {
      overlay.classList.remove("show");
      overlay.setAttribute('aria-hidden', 'true');
      document.querySelectorAll('input[type="radio"]').forEach(i=>i.checked=false);
      summaryBox.hidden = true;
      summaryBox.innerHTML = '';
      finishBtn.disabled = false;
      closeBtn.hidden = true;
      goTo(1);
    };

    /* Tiny heart burst (existing) */
    function miniBurst(){
      burst.innerHTML = '';
      const N = 24;
      const icons = ['ğŸ’–','ğŸ’—','ğŸ’','ğŸ’•','â¤ï¸','ğŸ’“','ğŸ’˜','ğŸ’š'];
      for(let i=0;i<N;i++){
        const p = document.createElement('div');
        p.className = 'p';
        p.textContent = icons[Math.floor(Math.random()*icons.length)];
        const angle = (Math.PI*2) * (i/N);
        const radius = 160 + Math.random()*80;
        const dx = Math.cos(angle)*radius;
        const dy = Math.sin(angle)*radius;
        p.style.setProperty('--dx', dx + 'px');
        p.style.setProperty('--dy', dy + 'px');
        const cx = window.innerWidth/2;
        const cy = window.innerHeight/2;
        p.style.left = (cx - 10) + 'px';
        p.style.top  = (cy - 10) + 'px';
        burst.appendChild(p);
        setTimeout(()=>p.remove(), 1100);
      }
    }

    /* =========================================================
       FESTIVAL FINALE: Everything romantic & extra ğŸ¥°
       ========================================================= */
    function grandFinaleFestival(){
      const layer = document.createElement('div');
      layer.className = 'finale-layer';
      document.body.appendChild(layer);

      // 1) BIG CENTER BLAST
      bigBlast(layer);

      // 2) EMOJI RAIN
      loveRain(layer, { durationMs: CONFIG.rainDurationMs, density: 30 });

      // 3) â€œLOVE YOU!â€ OVERLAY
      loveOverlay(layer);

      // 4) BALLOONS with initials/names
      balloonsRise(layer, { count: CONFIG.balloonCount, label: CONFIG.names.initials });

      // 5) ROSE GARDEN
      roseGarden(layer, { roses: CONFIG.roseCount });

      // 6) TYPEWRITER QUOTES
      typewriterBanner(layer, CONFIG.quotes);

      // 7) CURSOR SPARKLE TRAIL
      cursorTrail(CONFIG.cursorTrailMs);

      // 8) PHOTO REVEAL
      photoReveal(layer, CONFIG);

      // Cleanup the layer after the finale
      setTimeout(()=>layer.remove(), CONFIG.finaleMs);
    }

    function bigBlast(root){
      const emojis = ['ğŸ’–','ğŸ’—','ğŸ’','ğŸ’•','â¤ï¸','ğŸ’“','ğŸ’˜','ğŸ’‹','ğŸ˜˜','ğŸ˜š','ğŸ¥°'];
      const count = 52;
      const center = document.createElement('div');
      center.className = 'blast';
      root.appendChild(center);

      for(let i=0;i<count;i++){
        const piece = document.createElement('div');
        piece.className = 'piece';
        piece.textContent = emojis[Math.floor(Math.random()*emojis.length)];

        const angle = (Math.PI*2) * (i/count) + (Math.random()*0.35);
        const radius = 240 + Math.random()*180;
        const dx = Math.cos(angle)*radius;
        const dy = Math.sin(angle)*radius;

        piece.style.setProperty('--dx', dx + 'px');
        piece.style.setProperty('--dy', dy + 'px');
        center.appendChild(piece);
        setTimeout(()=>piece.remove(), 1200);
      }
      setTimeout(()=>center.remove(), 1300);
    }

    function loveRain(root, { durationMs=8000, density=24 }={}){
      const container = document.createElement('div');
      container.className = 'love-rain';
      root.appendChild(container);

      const drops = Math.min(density * Math.ceil(window.innerWidth/480), 140);
      const icons = ['ğŸ’–','ğŸ’—','ğŸ’','ğŸ’•','â¤ï¸','ğŸ’“','ğŸ’˜','ğŸ’‹','ğŸ˜˜','ğŸ˜š','ğŸ¥°'];

      const start = performance.now();
      function spawn(){
        const now = performance.now();
        if(now - start > durationMs) return;

        const d = document.createElement('div');
        d.className = 'drop';
        d.textContent = icons[Math.floor(Math.random()*icons.length)];
        d.style.left = (Math.random()*100) + 'vw';
        d.style.setProperty('--sx', ((Math.random()*2-1) * (40 + Math.random()*80)) + 'px');
        d.style.setProperty('--rot', (Math.random()*720 - 360) + 'deg');
        d.style.setProperty('--dur', (5 + Math.random()*3.5) + 's');
        container.appendChild(d);
        setTimeout(()=>d.remove(), 9000);

        const interval = Math.max(50, 200 - (drops));
        setTimeout(spawn, Math.random()*interval);
      }

      for(let i=0;i<Math.max(6, Math.floor(drops/6)); i++){
        setTimeout(spawn, i*120);
      }
      setTimeout(()=>container.remove(), durationMs + 9500);
    }

    function loveOverlay(root){
      const overlay = document.createElement('div');
      overlay.className = 'love-overlay';
      root.appendChild(overlay);

      const cols = Math.min(7, Math.max(4, Math.floor(window.innerWidth/260)));
      for(let i=0;i<cols;i++){
        const col = document.createElement('div');
        col.className = 'love-col';
        col.style.left = (i*(100/cols)) + '%';
        col.style.animationDuration = (9 + Math.random()*4) + 's';
        col.style.opacity = (0.14 + Math.random()*0.12).toFixed(2);

        const block = [];
        const repeats = 18;
        for(let r=0;r<repeats;r++){ block.push('Love you ğŸ’– Love you ğŸ’‹ Love you ğŸ¥°'); }
        col.textContent = block.join('  â€¢  ');
        overlay.appendChild(col);
      }
      setTimeout(()=>overlay.remove(), 9000);
    }

    function balloonsRise(root, { count=12, label="A â™¥ T" }={}){
      const container = document.createElement('div');
      container.className = 'balloons';
      root.appendChild(container);

      const icons = ['ğŸˆ','ğŸˆ','ğŸˆ','ğŸˆ','ğŸˆ','ğŸˆ'];
      for(let i=0;i<count;i++){
        const b = document.createElement('div');
        b.className = 'balloon';
        b.innerHTML = `<div class="emoji">${icons[Math.floor(Math.random()*icons.length)]}</div>
                       <div class="label">${Math.random()<0.6 ? label : 'Forever ğŸ’'}</div>`;
        b.style.left = (5 + Math.random()*90) + 'vw';
        b.style.setProperty('--dur', (7 + Math.random()*3) + 's');
        b.style.setProperty('--x', ((Math.random()*2 - 1) * 20) + 'px');
        b.style.setProperty('--sway', ((Math.random()*2 - 1) * (40 + Math.random()*30)) + 'px');
        container.appendChild(b);
        setTimeout(()=>b.remove(), CONFIG.finaleMs);
      }
      setTimeout(()=>container.remove(), CONFIG.finaleMs);
    }

    function roseGarden(root, { roses=24 }={}){
      const garden = document.createElement('div');
      garden.className = 'garden';
      root.appendChild(garden);

      const cols = Math.min(roses, Math.floor(window.innerWidth/28));
      for(let i=0;i<cols;i++){
        const r = document.createElement('div');
        r.className = 'rose';
        r.textContent = 'ğŸŒ¹';
        r.style.animationDelay = (Math.random()*1.2 + (i%6)*0.05) + 's';
        r.style.setProperty('--gdur', (2 + Math.random()*1.6) + 's');
        garden.appendChild(r);
      }
      setTimeout(()=>garden.remove(), CONFIG.finaleMs);
    }

    function typewriterBanner(root, msgs){
      const el = document.createElement('div');
      el.className = 'typewriter';
      root.appendChild(el);

      const caret = document.createElement('span');
      caret.className = 'caret';
      el.appendChild(caret);

      let idx = 0;
      const endAt = performance.now() + Math.min(CONFIG.finaleMs - 2000, 9500);

      function typeMsg(text, cb){
        el.firstChild && el.removeChild(el.firstChild);
        const span = document.createElement('span');
        el.insertBefore(span, caret);
        let i=0;
        const t = setInterval(()=>{
          span.textContent = text.slice(0, ++i);
          if(i>=text.length){ clearInterval(t); setTimeout(cb, 900); }
        }, 28);
      }

      function next(){
        const now = performance.now();
        if(now > endAt){ el.remove(); return; }
        typeMsg(msgs[idx], ()=>{ idx = (idx+1) % msgs.length; next(); });
      }
      next();
    }

    function cursorTrail(ms=5000){
      const icons = ['ğŸ’–','ğŸ’—','âœ¨','ğŸ’˜','ğŸ’•','ğŸ’‹'];
      let active = true;
      function handler(e){
        if(!active) return;
        const t = document.createElement('div');
        t.className = 'trail';
        t.textContent = icons[Math.floor(Math.random()*icons.length)];
        t.style.left = e.clientX + 'px';
        t.style.top  = e.clientY + 'px';
        document.body.appendChild(t);
        setTimeout(()=>t.remove(), 900);
      }
      window.addEventListener('mousemove', handler);
      setTimeout(()=>{ active=false; window.removeEventListener('mousemove', handler); }, ms);
    }

    function photoReveal(root, cfg){
      const frame = document.createElement('div');
      frame.className = 'photo-wrap';
      const img = document.createElement('img');
      img.className = 'photo';
      if(cfg.photoUrl && cfg.photoUrl.trim()){
        img.src = cfg.photoUrl;
        img.alt = `${cfg.names.left} & ${cfg.names.right}`;
      }else{
        // Cute placeholder with gradient + initials
        img.style.background = 'linear-gradient(135deg,#ffd1e0,#ffe7ef)';
        img.alt = 'Our photo';
      }
      const cap = document.createElement('div');
      cap.className = 'caption';
      cap.textContent = `${cfg.names.left}  â™¥  ${cfg.names.right}`;

      frame.appendChild(img);
      frame.appendChild(cap);
      root.appendChild(frame);

      // If placeholder, overlay initials
      if(!cfg.photoUrl){
        const overlay = document.createElement('div');
        overlay.style.position='absolute';
        overlay.style.inset='0';
        overlay.style.display='grid';
        overlay.style.placeItems='center';
        overlay.style.color='#b02a4a';
        overlay.style.fontWeight='800';
        overlay.style.fontSize='clamp(28px,6vw,42px)';
        overlay.style.textShadow='0 2px 8px rgba(255,255,255,.7)';
        overlay.textContent = cfg.names.initials;
        frame.appendChild(overlay);
        setTimeout(()=>overlay.remove(), 3500);
      }

      // Sparkles around frame corners
      const spr = ['âœ¨','ğŸ’–','ğŸ’«','ğŸ«¶'];
      const corners = [
        {x:-16,y:-16},{x:16,y:-16},{x:-16,y:16},{x:16,y:16}
      ];
      corners.forEach((c,i)=>{
        const s = document.createElement('div');
        s.className = 'sparkle';
        s.textContent = spr[i%spr.length];
        s.style.left = '50%'; s.style.top = '50%';
        s.style.transform = `translate(calc(-50% + ${c.x}px), calc(-50% + ${c.y}px))`;
        s.style.animationDelay = (0.2 * i) + 's';
        frame.appendChild(s);
        setTimeout(()=>s.remove(), 1300);
      });

      // Remove frame near finale end to keep DOM light
      setTimeout(()=>frame.remove(), Math.min(CONFIG.finaleMs - 600, 11000));
    }

    // Gentle chime using WebAudio (plays on click)
    function playChime(){
      try{
        const AudioCtx = window.AudioContext || window.webkitAudioContext;
        const ctx = new AudioCtx();
        const now = ctx.currentTime;

        function tone(freq, start, dur, gain=0.08){
          const osc = ctx.createOscillator();
          const g = ctx.createGain();
          osc.frequency.value = freq; osc.type = 'sine';
          osc.connect(g); g.connect(ctx.destination);
          g.gain.setValueAtTime(0, start);
          g.gain.linearRampToValueAtTime(gain, start+0.02);
          g.gain.exponentialRampToValueAtTime(0.0001, start + dur);
          osc.start(start); osc.stop(start + dur + 0.02);
        }

        const base = now + 0.02;
        tone(523.25, base, 0.5);      // C5
        tone(659.25, base+0.08, 0.5); // E5
        tone(783.99, base+0.16, 0.6); // G5
        tone(1046.50, base+0.36, 0.7, 0.06); // C6 sparkle
        tone(392.00, base, 1.2, 0.05); // G4 pad

        setTimeout(()=>ctx.close(), 1600);
      }catch(e){ /* ignore if blocked */ }
    }
  </script>

</body>
</html>
